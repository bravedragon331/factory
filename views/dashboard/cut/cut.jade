extends ./layout
block page-body
  .panel.panel-default.order-panel
    .panel-body
      h4 Order List
      table.table.table-bordered.table-striped.table-hover.js-basic-example.order-table.dataTable
        thead
          tr
            th Date
            th Handler
            th File#
            th Buyer
            th Style
            th Product
            th Season
            th Quantity
        tbody
  .panel.panel-default.add-cut-panel(style='display:none;')
    .panel-heading
      | Add Cut
    .panel-body
      form.add-form
        input(type="hidden").order-id
        .form-group.clearfix.col-md-2
          label.display-block PO
          select.select-bar.new-po(style='width: 100%;')
            option(value='-1') Not Selected            
        .form-group.clearfix.col-md-2
          label.display-block #{__("COLOR")}
          select.select-bar.new-color.select-fabric(style='width: 100%;')
            option(value='-1') Not Selected            
        .form-group.clearfix.col-md-2
          label.display-block #{__("COLOR CODE")}
          select.select-bar.new-colorcode.select-fabric(style='width: 100%;')
            option(value='-1') Not Selected
        .form-group.clearfix.col-md-2
          label.display-block LOTE
          input.form-control.new-lote(type='text', placeholder='LOTE')
        .form-group.clearfix.col-md-2
          label.display-block YDS
          input.form-control.new-yds(type='text', placeholder='YDS')
        .form-group.clearfix.col-md-2
          label.display-block CUT DATE
          input.form-control.new-cutdate(type='text', placeholder='Please choose a date...', data-format='YYYY-MM-DD')
        .form-group.clearfix.col-md-2
          label.display-block CUT ORD#
          input.form-control.new-cutord(type='text', placeholder='CUT ORD#', required)
        .form-group.clearfix.col-md-2.size-1
          label.display-block Size1
          input.form-control.new-size-1(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-2
          label.display-block Size2
          input.form-control.new-size-2(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-3
          label.display-block Size3
          input.form-control.new-size-3(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-4
          label.display-block Size4
          input.form-control.new-size-4(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-5
          label.display-block Size5
          input.form-control.new-size-5(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-6
          label.display-block Size6
          input.form-control.new-size-6(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-7
          label.display-block Size7
          input.form-control.new-size-7(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-8
          label.display-block Size8
          input.form-control.new-size-8(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-9
          label.display-block Size9
          input.form-control.new-size-9(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-10
          label.display-block Size10
          input.form-control.new-size-10(type='text', placeholder='')
        .form-group.clearfix.col-md-2
          label.display-block Envio#
          input.form-control.new-envio(type='text', placeholder='Envio#')
        .form-group.clearfix.col-md-2
          label.display-block Lienzos
          input.form-control.new-lienzos(type='text', placeholder='Lienzos#')
        .form-group.clearfix.col-md-2
          label.display-block Yds Etique.
          input.form-control.new-ydsetique(type='text', placeholder='Yds Etique')
        .form-group.clearfix.col-md-2
          label.display-block Malo
          input.form-control.new-malo(type='text', placeholder='Malo')
        .form-group.clearfix.col-md-2
          label.display-block Faltante
          input.form-control.new-faltante(type='text', placeholder='Faltante')
        .form-group.clearfix.col-md-2
          label.display-block Yds Used
          input.form-control.new-ydsused(type='text', placeholder='Yds Used')
        .form-group.clearfix.col-md-2
          label.display-block Bies
          input.form-control.new-bies(type='text', placeholder='Bies')
        .form-group.clearfix.col-md-2
          label.display-block Total
          input.form-control.new-total(type='text', placeholder='Total')
        .form-group.clearfix.col-md-2
          label.display-block Q'ty Rollo
          input.form-control.new-qtyrollo(type='text', placeholder='Qty Rollo')
        .form-group.clearfix.col-md-2
          label.display-block Tendedor
          input.form-control.new-tendedor(type='text', placeholder='Tendedor')
        .form-group.col-md-12
          button.btn.btn-sm.btn-success.pull-right(type='submit') Add Cut
  .panel.panel-default.update-cut-panel(style='display:none;')
    .panel-heading
      | Update Cut
    .panel-body
      form.update-form
        input(type="hidden").order-id
        input(type='hidden').old-id
        .form-group.clearfix.col-md-2
          label.display-block PO
          select.select-bar.update-po(style='width: 100%;')
            option(value='-1') Not Selected            
        .form-group.clearfix.col-md-2
          label.display-block #{__("COLOR")}
          select.select-bar.update-color.select-fabric(style='width: 100%;')
            option(value='-1') Not Selected            
        .form-group.clearfix.col-md-2
          label.display-block #{__("COLOR CODE")}
          select.select-bar.update-colorcode.select-fabric(style='width: 100%;')
            option(value='-1') Not Selected
        .form-group.clearfix.col-md-2
          label.display-block LOTE
          input.form-control.update-lote(type='text', placeholder='LOTE')
        .form-group.clearfix.col-md-2
          label.display-block YDS
          input.form-control.update-yds(type='text', placeholder='YDS')
        .form-group.clearfix.col-md-2
          label.display-block CUT DATE
          input.form-control.update-cutdate(type='text', placeholder='Please choose a date...', data-format='YYYY-MM-DD')
        .form-group.clearfix.col-md-2
          label.display-block CUT ORD#
          input.form-control.update-cutord(type='text', placeholder='CUT ORD#', required, readonly)
        .form-group.clearfix.col-md-2.size-1
          label.display-block Size1
          input.form-control.update-size-1(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-2
          label.display-block Size2
          input.form-control.update-size-2(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-3
          label.display-block Size3
          input.form-control.update-size-3(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-4
          label.display-block Size4
          input.form-control.update-size-4(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-5
          label.display-block Size5
          input.form-control.update-size-5(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-6
          label.display-block Size6
          input.form-control.update-size-6(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-7
          label.display-block Size7
          input.form-control.update-size-7(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-8
          label.display-block Size8
          input.form-control.update-size-8(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-9
          label.display-block Size9
          input.form-control.update-size-9(type='text', placeholder='')
        .form-group.clearfix.col-md-2.size-10
          label.display-block Size10
          input.form-control.update-size-10(type='text', placeholder='')
        .form-group.clearfix.col-md-2
          label.display-block Envio#
          input.form-control.update-envio(type='text', placeholder='Envio#')
        .form-group.clearfix.col-md-2
          label.display-block Lienzos
          input.form-control.update-lienzos(type='text', placeholder='Lienzos#')
        .form-group.clearfix.col-md-2
          label.display-block Yds Etique.
          input.form-control.update-ydsetique(type='text', placeholder='Yds Etique')
        .form-group.clearfix.col-md-2
          label.display-block Malo
          input.form-control.update-malo(type='text', placeholder='Malo')
        .form-group.clearfix.col-md-2
          label.display-block Faltante
          input.form-control.update-faltante(type='text', placeholder='Faltante')
        .form-group.clearfix.col-md-2
          label.display-block Yds Used
          input.form-control.update-ydsused(type='text', placeholder='Yds Used')
        .form-group.clearfix.col-md-2
          label.display-block Bies
          input.form-control.update-bies(type='text', placeholder='Bies')
        .form-group.clearfix.col-md-2
          label.display-block Total
          input.form-control.update-total(type='text', placeholder='Total')
        .form-group.clearfix.col-md-2
          label.display-block Q'ty Rollo
          input.form-control.update-qtyrollo(type='text', placeholder='Qty Rollo')
        .form-group.clearfix.col-md-2
          label.display-block Tendedor
          input.form-control.update-tendedor(type='text', placeholder='Tendedor')
        .form-group.col-md-12
          button.btn.btn-sm.btn-success.pull-right(type='submit') Update Cut
  
  .panel.panel-default.cut-list-panel(style='display:none;')
    .panel-heading
      | CUT List
    .panel-body
      .align-justify
        .p-b-10
          button.btn.btn-sm.btn-success.add-cut
            i.fa.fa-plus.m-r-5
            | Add New Cut
        table#mainTable.table.table-bordered.table-striped.detailview
          thead.bg-blue-grey
            tr
              th(rowspan='2') STYLE#
              th(rowspan='2', width='70') PO#
              th(rowspan='2', width='60') SHIP DATE
              th(rowspan='2') COLOR
              th(rowspan='2', width='60')
                | COLOR
                br
                | CODE#
              th(rowspan='2') LOTE
              th(rowspan='2') YDS
              th(rowspan='2', width='60') CUT DATE
              th(rowspan='2', width='60') CUT ORD#
              th.align-center.size-header-span SIZE
              th(rowspan='2') QTY
              th(rowspan='2') Envio#
              th(rowspan='2') Lienzos
              th(rowspan='2') Yds Etique.
              th(rowspan='2') Malo
              th(rowspan='2') Faltante
              th(rowspan='2') Yds Used
              th(rowspan='2') Bies
              th(rowspan='2') Total
              th(rowspan='2') Q'ty Rollo
              th(rowspan='2') Tendedor
            tr.sizeheader
          tbody
block script2
  script.
    var fabrics = (!{JSON.stringify(fabric)}), tasks, orderfabrics, orderftypes, fabric, allcustomers = (!{JSON.stringify(allcustomers)}), buyer, name, cutdata;

    function init(){          
      $('.new-shipdate').datetimepicker({
        format: 'YYYY-MM-DD',
        showClear: true
      });
      $('.new-cutdate').datetimepicker({
        format: 'YYYY-MM-DD',
        showClear: true
      });
      $('.new-po').select2();
      $('.new-color').select2();
      $('.new-colorcode').select2();
      var b1 = true;
      var b2 = true;
      $('.new-color').on('change', function(){
        if(b2){
          b1 = false;
          $('.new-colorcode').val($(this).val()).trigger('change');        
        }
        b2 = true;
      })
      $('.new-colorcode').on('change', function(){
        if(b1){
          b2 = false;
          $('.new-color').val($(this).val()).trigger('change');
        }
        b1 = true;
      })

      $('.update-shipdate').datetimepicker({
        format: 'YYYY-MM-DD',
        showClear: true
      });
      $('.update-cutdate').datetimepicker({
        format: 'YYYY-MM-DD',
        showClear: true
      });
      $('.update-po').select2();
      $('.update-color').select2();
      $('.update-colorcode').select2();
      var b1 = true;
      var b2 = true;
      $('.update-color').on('change', function(){
        if(b2){
          b1 = false;
          $('.update-colorcode').val($(this).val()).trigger('change');        
        }
        b2 = true;
      })
      $('.update-colorcode').on('change', function(){
        if(b1){
          b2 = false;
          $('.update-color').val($(this).val()).trigger('change');
        }
        b1 = true;
      })

      $('.add-cut-panel').on('click', 'a.panel-close', function () {
        $(this).parents('.add-cut-panel').fadeOut();
      });
      $('.update-cut-panel').on('click', 'a.panel-close', function () {
        $(this).parents('.update-cut-panel').fadeOut();
      });
      $('.add-cut').on('click', function(){
        $('.add-cut-panel').fadeIn();
        $('.update-cut-panel').fadeOut();
      })
    }

    init();

  
    $('.search-form').submit(function(e){
      e.preventDefault();
      var startdate = $('.in-date').val().split('-')[0];
      var enddate = $('.in-date').val().split('-')[1];

      $.ajax({
        url: '/dashboard/fabric/search',
        type: 'POST',
        data: {
          buyer: $('.buyer').val(),
          startdate: startdate,
          enddate: enddate,
          fabric_type: $('.fabric-type').val(),
          fabric: $('.fabric').val(),
          color: $('.color').val(),
          po: $('.po').val(),
          style: $('.style').val()
        },
        success: function(result){
          if(result.isSuccess){
            console.log(result.list);
            fillOrderTable(result.list);
          }else{
            alert('Cannot search.');
          }
        }
      })
    })

    var fillOrderTable = function(list){
      $('.order-panel').show();
      var tableData = [];
      for(let i = 0; i < list.length; i++){
        tableData.push([
          list[i].date.split('T')[0], list[i].handlername, list[i].name, list[i].buyername, list[i].style, list[i].product, list[i].season, list[i].quantity
        ])
      }
      $('.order-table').dataTable().fnClearTable();
      if(tableData.length > 0){
        $('.order-table').dataTable().fnAddData(tableData);
        $('.order-table').dataTable().fnDraw();
      }
      refreshEvent();
    }

    var orderdata;

    var refreshEvent = function(){
      $('.order-table tbody tr').off();
      $('.order-table tbody tr').on('click', function(){
        $('.cut-list-panel').show();

        name = $($(this).find('td')[2]).html();        
        buyer = $($(this).find('td')[3]).html();
        $.ajax({
          url: '/dashboard/cut/order_detail',
          type: 'POST',
          data: {
            name: name,
            buyer: buyer
          },
          success: function(data){
            if(data.isSuccess){
              console.log(data);
              orderdata = data;
              var ht = '', len = 0;
              for(var i = 1; i < 11; i++){
                if(data.sizegroup['size'+i] != -1){
                  for(var j = 0; j < data.sizes.length; j++){
                    if(data.sizes[j].id == data.sizegroup['size'+i]){
                      len++;
                      ht += `<th width = "60">`+data.sizes[j].name+`</th>`;
                      $('.size-'+i+'>label').html(data.sizes[j].name);
                    }
                  }
                  $('.size-'+i).show();                  
                }else{
                  $('.size-'+i).hide();
                }
              }
              $('.sizeheader').html(ht);
              $('.size-header-span').attr('colspan',len);

              $(".new-po").select2("destroy");
              $('.new-po').html("");
              $('.new-po').append(
                  '<option value="-1">Not Selected</option>'
              );
              var tmp = [];
              $.each(data.orderdetails, function(index, value) {
                if(!tmp.includes(data.orderdetails[index].po)){
                  tmp.push(data.orderdetails[index].po);
                  $('.new-po').append(
                    '<option value="' + data.orderdetails[index].po + '">' + data.orderdetails[index].po + '</option>'
                  );
                }
                
              });
              $(".new-po").select2();

              $('.new-po').on('change', function(){
                var po = $(this).val();

                $(".new-color").select2("destroy");
                $('.new-color').html("");
                $('.new-color').append(
                    '<option value="-1">Not Selected</option>'
                );
                var colorname = [];
                for(var index = 0; index < data.orderdetails.length; index++){
                  if(po != data.orderdetails[index].po) continue;

                  if(!colorname.includes(data.orderdetails[index].colorname)){
                    
                    $('.new-color').append(
                      '<option value="' + data.orderdetails[index].color + '">' + data.orderdetails[index].colorname + '</option>'
                    );
                    colorname.push(data.orderdetails[index].colorname);
                  }
                }
                $(".new-color").select2();

                $(".new-colorcode").select2("destroy");
                $('.new-colorcode').html("");
                $('.new-colorcode').append(
                    '<option value="-1">Not Selected</option>'
                );
                var colorcode = [];
                for(var index = 0; index < data.orderdetails.length; index++) {
                  if(po != data.orderdetails[index].po) continue;

                  if(!colorcode.includes(data.orderdetails[index].color)){
                    $('.new-colorcode').append(
                      '<option value="' + data.orderdetails[index].color + '">' + data.orderdetails[index].color + '</option>'
                    );
                    colorcode.push(data.orderdetails[index].color);
                  }                
                };
                $(".new-colorcode").select2();
              })

              // Update Form
              $('.update-po').select2("destroy");
              $('.update-po').html("");
              $('.update-po').append(
                  '<option value="-1">Not Selected</option>'
              );
              var tmp = [];
              $.each(data.orderdetails, function(index, value) {
                if(!tmp.includes(data.orderdetails[index].po)){
                  tmp.push(data.orderdetails[index].po);
                  $('.update-po').append(
                    '<option value="' + data.orderdetails[index].po + '">' + data.orderdetails[index].po + '</option>'
                  );
                }
              });
              $(".update-po").select2();

              $('.update-po').on('change', function(){
                var po = $(this).val();

                $(".update-color").select2("destroy");
                $('.update-color').html("");
                $('.update-color').append(
                    '<option value="-1">Not Selected</option>'
                );
                var colorname = [];
                for(var index = 0; index < data.orderdetails.length; index++){
                  if(po != data.orderdetails[index].po) continue;

                  if(!colorname.includes(data.orderdetails[index].colorname)){
                    
                    $('.update-color').append(
                      '<option value="' + data.orderdetails[index].color + '">' + data.orderdetails[index].colorname + '</option>'
                    );
                    colorname.push(data.orderdetails[index].colorname);
                  }
                }
                $(".update-color").select2();

                $(".update-colorcode").select2("destroy");
                $('.update-colorcode').html("");
                $('.update-colorcode').append(
                    '<option value="-1">Not Selected</option>'
                );
                var colorcode = [];
                for(var index = 0; index < data.orderdetails.length; index++) {
                  if(po != data.orderdetails[index].po) continue;

                  if(!colorcode.includes(data.orderdetails[index].color)){
                    $('.update-colorcode').append(
                      '<option value="' + data.orderdetails[index].color + '">' + data.orderdetails[index].color + '</option>'
                    );
                    colorcode.push(data.orderdetails[index].color);
                  }                
                };
                $(".update-colorcode").select2();
              })

              loadCutData();
            }else{
              alert('Cannot load order data.');
            }
          }
        });
      });
    }

    var loadCutData = function(){
      $('.update-cut-panel').fadeOut();
      $('.add-cut-panel').fadeOut();
      $.ajax({
        url: '/dashboard/cut/list',
        type: 'POST',
        data: {
          orderid: orderdata.order.id
        },
        success: function(result){
          if(result.isSuccess){
            cutdata = result.list;
            var ht = '';            
            for(var i = 0; i < result.list.length; i++){
              ht += '<tr>';
              for(var j = 0; j < orderdata.orderdetails.length; j++){
                if(result.list[i].po == orderdata.orderdetails[j].id){
                  ht += '<td class="StringData">'+ orderdata.orderdetails[j].style+'</td>';
                  ht += '<td class="StringData">'+ orderdata.orderdetails[j].po+'</td>';
                  ht += '<td class="StringData">'+ orderdata.orderdetails[j].shipdate+'</td>';
                  ht += '<td class="StringData">'+ orderdata.orderdetails[j].colorname+'</td>';
                  ht += '<td class="StringData">'+ orderdata.orderdetails[j].color+'</td>';                  
                }
              }
              ht += '<td class="StringData">'+ result.list[i].lote + '</td>';
              ht += '<td class="StringData">'+ result.list[i].yds + '</td>';
              ht += '<td class="StringData">'+ result.list[i].cutdate + '</td>';
              ht += '<td class="StringData">'+ result.list[i].cutord + '</td>';
              var sum = 0;
              for(var j = 1; j < 11; j++){
                if(orderdata.sizegroup['size'+j] != -1){
                  console.log(j);
                  sum += Number(result.list[i]['size'+j]);
                  ht += '<td class="NumericData">'+ result.list[i]['size'+j] + '</td>';
                }
              }
              ht += '<td>'+sum+'</td>';
              ht += '<td class="NumericData">'+ result.list[i].envio + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].lienzos + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].ydsetique + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].malo + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].faltante + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].ydsused + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].bies + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].total + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].qtyrollo + '</td>';
              ht += '<td class="NumericData">'+ result.list[i].tendedor + '</td>';

              ht + '</tr>'
            }
            $('.cut-list-panel tbody').html(ht);

            refreshTableEvent();

          }else{
            alert('Cannot load Cut data');        
          }
        }
      })
    }

    var refreshTableEvent = function(){
      $('.cut-list-panel tbody tr').on('click', function(){
        $('.update-cut-panel').fadeIn();
        $('.add-cut-panel').fadeOut();
                
        var po = $($(this).find('td')[1]).html();
        var cutord = $($(this).find('td')[8]).html();
        console.log(cutdata);
        for(var i = 0; i < cutdata.length; i++){
          for(var j = 0; j < orderdata.orderdetails.length; j++){
            if(cutdata[i].po == orderdata.orderdetails[j].id && orderdata.orderdetails[j].po == po && cutord == cutdata[i].cutord){
              fillUpdateForm(cutdata[i], po);
            }
          }
        }
      })
    }

    var fillUpdateForm = function(data, po){
      $('.update-po').val(po).trigger('change');
      $('.old-id').val(data.id);
      setTimeout(function(){
        $('.update-color').val(data.color).trigger('change');
      }, 500);
      $('.update-lote').val(data.lote);
      $('.update-yds').val(data.yds);
      $('.update-cutdate').val(data.cutdate);
      $('.update-cutord').val(data.cutord);
      $('.update-size-1').val(data.size1);
      $('.update-size-2').val(data.size2);
      $('.update-size-3').val(data.size3);
      $('.update-size-4').val(data.size4);
      $('.update-size-5').val(data.size5);
      $('.update-size-6').val(data.size6);
      $('.update-size-7').val(data.size7);
      $('.update-size-8').val(data.size8);
      $('.update-size-9').val(data.size9);
      $('.update-size-10').val(data.size10);
      $('.update-envio').val(data.envio);
      $('.update-lienzos').val(data.lienzos);
      $('.update-ydsetique').val(data.ydsetique);
      $('.update-malo').val(data.malo);
      $('.update-faltante').val(data.faltate);
      $('.update-ydsused').val(data.ydsused);
      $('.update-bies').val(data.bies);
      $('.update-total').val(data.total);
      $('.update-qtyrollo').val(data.qtyrollo);
      $('.update-tendedor').val(data.tendedor);
    }

    $('.add-form').submit(function(e){
      e.preventDefault();
      let po;
      for(var i = 0; i < orderdata.orderdetails.length; i++){
        if(orderdata.orderdetails[i].po == $('.new-po').val() && orderdata.orderdetails[i].color == $('.new-color').val()){
          po = orderdata.orderdetails[i].id;
        }
      }
      $.ajax({
        url: '/dashboard/cut/add',
        type: 'POST',
        data: {
          order: orderdata.order.id,
          po: po,
          color: $('.new-color').val(),
          lote: $('.new-lote').val(),
          yds: $('.new-yds').val(),
          cutdate: $('.new-cutdate').val(),
          cutord: $('.new-cutord').val(),
          size1: $('.new-size-1').val(),
          size2: $('.new-size-2').val(),
          size3: $('.new-size-3').val(),
          size4: $('.new-size-4').val(),
          size5: $('.new-size-5').val(),
          size6: $('.new-size-6').val(),
          size7: $('.new-size-7').val(),
          size8: $('.new-size-8').val(),
          size9: $('.new-size-9').val(),
          size10: $('.new-size-10').val(),
          envio: $('.new-envio').val(),
          lienzos: $('.new-lienzos').val(),
          ydsetique: $('.new-ydsetique').val(),
          malo: $('.new-malo').val(),
          faltante: $('.new-faltante').val(),
          ydsused: $('.new-ydsused').val(),
          bies: $('.new-bies').val(),
          total: $('.new-total').val(),
          qtyrollo: $('.new-qtyrollo').val(),
          tendedor: $('.new-tendedor').val()
        },
        success: function(data){
          if(data.isSuccess){
            loadCutData();
          }else{
            alert('Cannot save Cut data.');
          }
        }
      })
    })

    $('.update-form').submit(function(e){
      e.preventDefault();
      let po;
      for(var i = 0; i < orderdata.orderdetails.length; i++){
        if(orderdata.orderdetails[i].po == $('.update-po').val() && orderdata.orderdetails[i].color == $('.update-color').val()){
          po = orderdata.orderdetails[i].id;
        }
      }
      $.ajax({
        url: '/dashboard/cut/update',
        type: 'POST',
        data: {
          order: orderdata.order.id,
          oldid: $('.old-id').val(),
          po: po,
          color: $('.update-color').val(),
          lote: $('.update-lote').val(),
          yds: $('.update-yds').val(),
          cutdate: $('.update-cutdate').val(),
          cutord: $('.update-cutord').val(),
          size1: $('.update-size-1').val(),
          size2: $('.update-size-2').val(),
          size3: $('.update-size-3').val(),
          size4: $('.update-size-4').val(),
          size5: $('.update-size-5').val(),
          size6: $('.update-size-6').val(),
          size7: $('.update-size-7').val(),
          size8: $('.update-size-8').val(),
          size9: $('.update-size-9').val(),
          size10: $('.update-size-10').val(),
          envio: $('.update-envio').val(),
          lienzos: $('.update-lienzos').val(),
          ydsetique: $('.update-ydsetique').val(),
          malo: $('.update-malo').val(),
          faltante: $('.update-faltante').val(),
          ydsused: $('.update-ydsused').val(),
          bies: $('.update-bies').val(),
          total: $('.update-total').val(),
          qtyrollo: $('.update-qtyrollo').val(),
          tendedor: $('.update-tendedor').val()
        },
        success: function(data){
          if(data.isSuccess){
            loadCutData();
          }else{
            alert('Cannot save Cut data.');
          }
        }
      })
    })